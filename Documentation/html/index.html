<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-right:0.5em; padding-top:0.5em; padding-bottom:0.5em;" id="projectlogo"><img alt="Logo" height="40" src="mfp_logo_lg_web.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MyFitnessPal SDK for iOS - Installation and Usage Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>The purpose of this document is to provide installation and usage instructions for the MyFitnessPal SDK for iOS. If your browser supports Javascript and CSS, you should be able to browse the public classes and files for the SDK within the left tree view.</p>
<h1><a class="anchor" id="changes_sec"></a>
Changes In This Release</h1>
<p>There are a number of changes in this release. The most important one is that you no longer have to pull source code from Github and build into your project. The SDK is now a pre-built framework that you pull into your project just like any other 3rd party framework.</p>
<p>Additional changes:</p>
<ul>
<li>
Access and refresh tokens are stored by the SDK - you no longer have to manage these. However, you can specify the cache key used for storing the token data in NSUserDefaults. </li>
<li>
Delegation has been deprecated. These have been replaced with blocks, which were previously supported but the requirement for one or the other has been removed. Use of the blocks have been simplified with typedef declarations that are available in the public <a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> interface. </li>
</ul>
<h1><a class="anchor" id="install_sec"></a>
Installation</h1>
<h2><a class="anchor" id="download"></a>
Download the framework and documentation</h2>
<p>You can download the latest release of the SDK from <a href="https://drive.google.com/a/myfitnesspal.com/folderview?id=0B6tjZ_J5LSJIOGVVdlVldlJURFE&amp;usp=sharing">here</a>.</p>
<h2><a class="anchor" id="install"></a>
Installing the Framework</h2>
<p>Unzip the MyFitnessPalSDK.zip file and you should see the following contents:</p>
<pre>
     MyFitnessPalSDK.framework
     docs/
     sample_code/
 </pre><table  class="directory">
<tr class="even">
<th style="text-align:left; padding: 5px 10px;">Name</th><th style="text-align:left; padding:5px 10px;">Description </th></tr>
<tr class="entry">
<td style="padding: 5px 10px;">MyFitnessPalSDK.framework</td><td style="padding: 5px 10px;">iOS framework - link this into your Xcode project </td></tr>
<tr class="even">
<td style="padding: 5px 10px;">docs/</td><td style="padding: 5px 10px;">Documentation for the SDK - installation, usage, and class definitions </td></tr>
<tr class="entry">
<td style="padding: 5px 10px;">sample_code/</td><td style="padding: 5px 10px;">A sample application that implements the session capabilities and some basic features of the SDK </td></tr>
</table>
<h2><a class="anchor" id="link_framework"></a>
Link The Framework Into Your iOS Project</h2>
<p>To link the MyFitnessPal.framework with your source code, you should be able to just drag and drop the MyFitnessPalSDK.framework file into Frameworks in your iOS project.</p>
<div class="image">
<img src="framework-import.png" alt="framework-import.png"/>
<div class="caption">
Importing the framework into Xcode</div></div>
 <h1><a class="anchor" id="configuration"></a>
Configuring Xcode</h1>
<h2><a class="anchor" id="required_frameworks"></a>
Required Frameworks</h2>
<p>The MyFitnessPalSDK framework requires the following additional frameworks be linked into your project:</p>
<table  class="directory">
<tr class="even">
<th style="text-align:left; padding: 5px 10px;">Framework</th><th style="text-align:left; padding:5px 10px;">Description </th></tr>
<tr class="entry">
<td style="padding: 5px 10px;">System Configuration Framework </td><td style="padding: 5px 10px;">The System Configuration framework provides functions that determine the reachability of target hosts in both a synchronous and an asynchronous manner. It also provides error detection facilities. (Source: <a href="https://developer.apple.com/library/ios/documentation/networking/Reference/SysConfig/_index.html">https://developer.apple.com/library/ios/documentation/networking/Reference/SysConfig/_index.html</a>   </td></tr>
<tr class="even">
<td style="padding: 5px 10px;">Security Framework </td><td style="padding: 5px 10px;">Defines C interfaces for protecting information and controlling access to software. (Source: <a href="https://developer.apple.com/library/ios/documentation/Security/Reference/SecurityFrameworkReference/_index.html">https://developer.apple.com/library/ios/documentation/Security/Reference/SecurityFrameworkReference/_index.html</a>  </td></tr>
<tr class="entry">
<td style="padding: 5px 10px;">libz.dylib </td><td style="padding: 5px 10px;">Dynamic library for Zlib, a general compression library.  </td></tr>
</table>
<h2><a class="anchor" id="supported_architectures"></a>
Supported Architectures</h2>
<p>You should be able to build your project for the following supported architectures:</p>
<pre>armv7 armv7s arm64</pre><p>Simulator builds can be done for:</p>
<pre>i386 x86_64</pre><h1><a class="anchor" id="sessions"></a>
Accessing the MyFitnessPal API Service</h1>
<p>There are two ways you can gain access to the MyFitnessPal API service:</p>
<ul>
<li>
<a class="el" href="index.html#token">Access Token</a></li>
<li>
<a class="el" href="index.html#auth_code">Authorization Code</a></li>
</ul>
<h2><a class="anchor" id="token"></a>
Access and Refresh Tokens</h2>
<p>You obtain an access/refresh token pair through "app to app linking." To obtain an access/refresh token pair, the SDK will open the native MyFitnessPal iOS application to initiate the OAuth flow. The native app employs the Implicit grant flow of OAuth 2.0 (<a href="http://tools.ietf.org/html/rfc6749">http://tools.ietf.org/html/rfc6749</a>).<br/>
<br/>
</p>
<p>The access token returned from the OAuth flow (see <a class="el" href="index.html#oath_flow">OAuth flow below</a>) is long-lived in version 1.x of the SDK and MyFitnessPal API, however, the SDK will automatically try and refresh the token if it is expired.</p>
<p>Once you have an access token, you can then make API requests, given the permissions you have been granted (see <a class="el" href="index.html#permissions">permissions</a> for more information).</p>
<h2><a class="anchor" id="auth_code"></a>
Authorization Code</h2>
<p>The Authorization Code grant type in OAuth 2.0 (<a href="http://tools.ietf.org/html/rfc6749#section-1.3.1">http://tools.ietf.org/html/rfc6749#section-1.3.1</a>) provides a short-lived (10 minute expiration) token that can be exchanged for an access/refresh token pair. However, the authorization code requires the client secret be sent to the MyFitnessPal authorization server, so the SDK will only provide the ability to obain an authorization code. Once an authorization code is obtained, it needs to be sent to the client server so it can be exchanged with the MyFitnessPal API authorization service for an access/refresh token pair.</p>
<h2><a class="anchor" id="oath_flow"></a>
OAuth Request</h2>
<p>The following describes the OAuth flow that is initiated by the SDK when doing app-to-app linking (i.e. connecting your user to his/her MyFitnessPal account):</p>
<ol>
<li>
The client application (your app) initiates the flow by opening the native MyFitnessPal iOS app (note - if the MyFitnessPal iOS app is not installed, the user will be redirected to the iTunes store to install the app). </li>
<li>
The MyFitnessPal app opens to a deep link that presents an authorization screen. </li>
<li>
If the user selects "Allow", the client application is opened and is passed the access and refresh tokens. </li>
<li>
The SDK stores the access and refresh tokens so they can be used to make subsequent API calls from the client or be sent to the client's server for server-to-server API requests. </li>
</ol>
<div class="image">
<img src="oauth-flow.png" alt="oauth-flow.png"/>
<div class="caption">
OAuth flow</div></div>
 <h2><a class="anchor" id="permissions"></a>
Permissions</h2>
<p>Currently, only "diary" and "diary_readonly" are supported.</p>
<h1><a class="anchor" id="session"></a>
Creating a Session</h1>
<p>This section explains how you can add code to your project to create a MyFitnessPal session, including obtaining an access token.<br/>
</p>
<p>These are the high-level steps you'll need, in order to obtain an access token and start a session:</p>
<ol>
<li>
Create a shared instance of the <a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> class: [<a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> activeSession]. See <a class="el" href="index.html#mfp_session_creation">Creating an MFPSession Object</a> </li>
<li>
Obtain an access token. See <a class="el" href="index.html#mfp_session_access_token">Obtaining an Access Token</a> </li>
<li>
Use the access token to make subsequent API requests </li>
</ol>
<h2><a class="anchor" id="session_prerequisites"></a>
Prerequisites</h2>
<p>Before you can obtain an access token or authorization code, you'll need to <a class="el" href="index.html#session_prerequisites_handle_open_url">add code to your app delegate</a> along with <a class="el" href="index.html#session_prerequisites_set_url_type">registering a URL type</a>.</p>
<h3><a class="anchor" id="session_prerequisites_handle_open_url"></a>
Update Application Delegate</h3>
<p>In order to use <a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> to create an activeSession, you'll need to add code to application:openURL:sourceApplication:annotation in your AppDelegate class (or whatever class you are using for your application delegate). The SDK will has a handleOpenURL method that will check the URL scheme along with the path, to ensure it is supposed to handle the request.</p>
<pre>#import &lt;<a class="el" href="_my_fitness_pal_s_d_k_8h.html">MyFitnessPalSDK/MyFitnessPalSDK.h</a>&gt;</pre> <pre>- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {</pre> <pre>
     if ([[<a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> activeSession] handleOpenURL:url]) {</pre><pre>       if ([[<a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> activeSession] isOpen]) {
         NSLog("Session opened");
       }</pre><pre>       return TRUE;</pre><pre>     } else {
       ... other handlers ...
     }</pre><pre>     return TRUE;</pre><pre>   }
 </pre><h3><a class="anchor" id="session_prerequisites_set_url_type"></a>
Setting the URL Type</h3>
<p>In order for the native MyFitnessPal iOS app to call back into your app, you'll need to set a URL Type in Xcode. Go to Targets -&gt; "target name" -&gt; Info -&gt; URL Types. From there, you can set a target URL. The URL scheme must have a prefix of "mfp". Optionally, if you have multiple apps on the same device, you can have a suffix such as "premium."</p>
<p>Putting it all together, your URL scheme would be "mfp-sampleapiclient-premium." If you only have one app, then the URL scheme would be "mfp-sampleapiclient."</p>
<p>Example:</p>
<div class="image">
<img src="setting-url-types.png" alt="setting-url-types.png"/>
<div class="caption">
Setting the URL Type in Xcode</div></div>
 <h2><a class="anchor" id="mfp_session_creation"></a>
Creating an MFPSession Object</h2>
<p>To create an <a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> object, you'll need a valid client ID. In the example below, urlSchemeSuffix is left nil. This will result in a callback URL scheme of "mfp-sampleapiclient" when [[UIApplication sharedApplication] openURL:] is invoked to launch your application with the returned access token from the initial OAuth request. See <a class="el" href="index.html#session_prerequisites_set_url_type">Setting the URL Type</a> for more information.</p>
<pre>#import &lt;<a class="el" href="_my_fitness_pal_s_d_k_8h.html">MyFitnessPalSDK/MyFitnessPalSDK.h</a>&gt;</pre> <pre>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {</pre> <pre>
   _mfpSession = [[<a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> alloc] initWithClientId:"sampleapiclient"
                                      urlSchemeSuffix:nil
                                         responseType:MFPAuthorizationTypeAccessToken
                                             cacheKey:nil];</pre><pre>   return YES;</pre><pre> }
 </pre><p>However, if you have multiple apps on the same device and want to ensure that the correct app is opened, you'll need to provide a urlSchemeSuffix. An example would be a suffix of "premium". This would result in a URL scheme of "mfp-sampleapiclient-premium".</p>
<h2><a class="anchor" id="mfp_session_access_token"></a>
Obtaining an Access Token</h2>
<p>To obtain an access token, you'll need to invoke the openActiveSessionWithScope:onSuccess:onFailure method of the <a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> shared instance.</p>
<h3><a class="anchor" id="callback_handlers"></a>
Callback Handlers</h3>
<p>Two callback handlers are available for success and completion blocks. These can be defined with the <a class="el" href="_m_f_p_session_8h.html#af2b3ff4d2f4b62ce93f7aeb7eb038e0b">MFPSuccessCallback</a> and <a class="el" href="_m_f_p_session_8h.html#ada444c923182c6642c6a78122b6ce16f">MFPFailureCallback</a> block typedefs.</p>
<h3><a class="anchor" id="open_active_session_example"></a>
Opening an Active Session</h3>
<p>In the code snippet below, openActiveSessionWithScope:onSuccess:onFailure takes a list of permissions. Currently, only "diary" and "diary_readonly" are supported. These are replaced with the constants: MFPPermissionTypeDiary and MFPPermissionTypeDiaryReadOnly respectively.</p>
<pre></pre><pre>#import &lt;<a class="el" href="_my_fitness_pal_s_d_k_8h.html">MyFitnessPalSDK/MyFitnessPalSDK.h</a>&gt;</pre><pre>MFPSuccessCallback onSuccess = ^() {</pre><pre>  NSLog("Successfully obtained an access token");</pre><pre>};</pre><pre>MFPFailureCallback onFailure = ^(NSError **error) {</pre><pre>  NSLog("Failed to obtain an access token: %", [*error description]);</pre><pre>};</pre><pre>[[<a class="el" href="interface_m_f_p_session.html" title="MyFitnessPal API session and access token management. ">MFPSession</a> activeSession] openActiveSessionWithScope:@[MFPPermissionTypeDiary]
                                             onSuccess:onSuccess
                                             onFailure:onFailure];
</pre><h1><a class="anchor" id="sample_app"></a>
Using the Included Sample Code</h1>
<p>Included with the contents of the SDK is a sample application that does the following:</p>
<ul>
<li>
Obtains either an access/refresh token pair or an authorization code </li>
<li>
Provides the ability to revoke an access token </li>
<li>
Tests the API server by sending a user-supplied string to the "echo" remote method (using the <a class="el" href="interface_m_f_p_echo.html" title="Implements a basic ping test of the MyFitnessPal API service. ">MFPEcho</a> class) </li>
</ul>
<h2><a class="anchor" id="sample_app_usage"></a>
Running the Sample App</h2>
<ol>
<li>
Open the mfp-sdk-sample-ios-app Xcode project under sample_code/ </li>
<li>
Drag and drop MyFitnessPalSDK.framework into Frameworks - see <a class="el" href="index.html#link_framework">Link the Framework Into Your iOS Project</a> </li>
<li>
Build/Run the sample app </li>
</ol>
<h2><a class="anchor" id="adhoc_requests"></a>
Ad Hoc API Requests</h2>
<p>Included in the SDK is a public class: <a class="el" href="interface_m_f_p_ad_hoc_request.html" title="A pass-through handler that allows for querying the MyFitnessPal API directly (version 1...">MFPAdHocRequest</a>. This is only for SDK 1.x clients, to provide feature parity with versions 1.0 and 1.1 of the SDK. Some developers may not have a server-side deployment that can access the MyFitnessPal API. Subsequently, the <a class="el" href="interface_m_f_p_ad_hoc_request.html" title="A pass-through handler that allows for querying the MyFitnessPal API directly (version 1...">MFPAdHocRequest</a> class acts as a wrapper for making server-side API requests. Please note that in previous versions of the SDK, you had to encode and decode the JSON requests and responses yourself. In this version, that is taken care of by sendRequestForActionName:withParams:onSuccess:onFailure, along with the inclusion of the action_name and access_token parameters.</p>
<p>In 2.x versions of the SDK and beyond, ad hoc API requests will be replaced by specific concrete class implementations of the respective, underlying models being referenced in the read/write requests to the API. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
